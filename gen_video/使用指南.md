# AIè§†é¢‘ç”Ÿæˆç³»ç»Ÿ - ä½¿ç”¨æŒ‡å—

## å½“å‰çŠ¶æ€

ç³»ç»Ÿå·²åˆ›å»ºå®Œæˆï¼ŒåŒ…å«ä»¥ä¸‹ç»„ä»¶ï¼š

1. âœ… **è„šæœ¬è§£æå™¨** (`script_parser.py`) - è§£æ Markdown åˆ†é•œè„šæœ¬
2. âœ… **è§†é¢‘ç”Ÿæˆå™¨** (`video_generator.py`) - ä½¿ç”¨ SVD ç”Ÿæˆè§†é¢‘
3. âœ… **TTS ç”Ÿæˆå™¨** (`tts_generator.py`) - ç”Ÿæˆé…éŸ³
4. âœ… **å­—å¹•ç”Ÿæˆå™¨** (`subtitle_generator.py`) - ç”Ÿæˆå­—å¹•
5. âœ… **è§†é¢‘åˆæˆå™¨** (`video_composer.py`) - åˆæˆæœ€ç»ˆè§†é¢‘
6. âœ… **ä¸»ç¨‹åº** (`main.py`) - å®Œæ•´æµæ°´çº¿
7. âœ… **è¿è¡Œè„šæœ¬** (`run_pipeline.py`) - ä¸€é”®è¿è¡Œ

## å¿«é€Ÿå¼€å§‹

### 1. æµ‹è¯•ç³»ç»Ÿ

é¦–å…ˆè¿è¡Œæµ‹è¯•è„šæœ¬ï¼Œæ£€æŸ¥ç³»ç»Ÿé…ç½®ï¼š

```bash
cd gen_video
python test_script.py
```

### 2. è¿è¡Œå®Œæ•´æµæ°´çº¿

```bash
python run_pipeline.py \
    --markdown ../çµç•Œ/2.md \
    --image-dir ../çµç•Œ/img2/jpgsrc \
    --output lingjie_ep2
```

æˆ–ä½¿ç”¨å¿«é€Ÿå¯åŠ¨è„šæœ¬ï¼š

```bash
bash quick_start.sh
```

## åˆ†æ­¥æ‰§è¡Œï¼ˆæ¨èç”¨äºè°ƒè¯•ï¼‰

å¦‚æœå®Œæ•´æµæ°´çº¿é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥åˆ†æ­¥æ‰§è¡Œï¼š

### æ­¥éª¤1: è§£æè„šæœ¬

```bash
python script_parser.py \
    --markdown ../çµç•Œ/2.md \
    --image-dir ../çµç•Œ/img2/jpgsrc \
    --output temp/script.json
```

è¿™å°†ç”Ÿæˆ JSON æ ¼å¼çš„è„šæœ¬æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰åœºæ™¯å’Œæ—ç™½ä¿¡æ¯ã€‚

### æ­¥éª¤2: ç”Ÿæˆè§†é¢‘ç‰‡æ®µï¼ˆéœ€è¦ SVD æ¨¡å‹ï¼‰

```bash
# å•ä¸ªå›¾åƒç”Ÿæˆè§†é¢‘
python video_generator.py \
    --input ../çµç•Œ/img2/jpgsrc/éŸ©ç«‹1.jpg \
    --output outputs/test_video.mp4

# æ‰¹é‡ç”Ÿæˆ
python video_generator.py \
    --input ../çµç•Œ/img2/jpgsrc \
    --output outputs/videos
```

**æ³¨æ„**: éœ€è¦å…ˆå®‰è£… generative-models å’Œä¸‹è½½ SVD æ¨¡å‹ã€‚

### æ­¥éª¤3: ç”Ÿæˆé…éŸ³

```bash
python tts_generator.py \
    --text "å½“éŸ©ç«‹å†æ¬¡çå¼€åŒçœ¼ï¼Œå‘ç°è‡ªå·±èº«å¤„ä¸€ç‰‡èŒ«èŒ«é»„æ²™ä¹‹ä¸­ã€‚" \
    --output outputs/audio.wav
```

### æ­¥éª¤4: ç”Ÿæˆå­—å¹•

```bash
python subtitle_generator.py \
    --audio outputs/audio.wav \
    --output outputs/subtitle.srt
```

### æ­¥éª¤5: åˆæˆæœ€ç»ˆè§†é¢‘

```bash
python video_composer.py \
    --videos outputs/videos/*.mp4 \
    --audio outputs/audio.wav \
    --subtitle outputs/subtitle.srt \
    --output outputs/final.mp4
```

## é…ç½®è¯´æ˜

ç¼–è¾‘ `config.yaml` æ–‡ä»¶å¯ä»¥è°ƒæ•´ï¼š

### è§†é¢‘ç”Ÿæˆå‚æ•°

```yaml
video:
  model_type: "svd-xt"  # æ¨¡å‹ç±»å‹
  num_frames: 25        # ç”Ÿæˆå¸§æ•°
  fps: 12               # å¸§ç‡
  width: 1024           # è§†é¢‘å®½åº¦
  height: 576           # è§†é¢‘é«˜åº¦
  motion_bucket_id: 127 # è¿åŠ¨å¹…åº¦ï¼ˆ1-255ï¼Œè¶Šå¤§è¿åŠ¨è¶Šæ˜æ˜¾ï¼‰
  noise_aug_strength: 0.02  # å™ªå£°å¢å¼ºå¼ºåº¦
```

### TTS å‚æ•°

```yaml
tts:
  engine: "chattts"     # TTS å¼•æ“
  temperature: 0.7      # æ¸©åº¦å‚æ•°
  speed: 1.0            # è¯­é€Ÿ
```

### å­—å¹•å‚æ•°

```yaml
subtitle:
  model_size: "large-v3"  # Whisper æ¨¡å‹å¤§å°
  language: "zh"          # è¯­è¨€ä»£ç 
  format: "srt"           # å­—å¹•æ ¼å¼
```

## å¸¸è§é—®é¢˜

### 1. æ¨¡å‹æœªä¸‹è½½

**é—®é¢˜**: `video_generator.py` æŠ¥é”™æ¨¡å‹æœªæ‰¾åˆ°

**è§£å†³**: 
- å®‰è£… generative-models: `git clone https://github.com/Stability-AI/generative-models.git`
- ä¸‹è½½ SVD æ¨¡å‹ï¼ˆä½¿ç”¨ huggingface-cli æˆ–æ‰‹åŠ¨ä¸‹è½½ï¼‰
- è®¾ç½®ç¯å¢ƒå˜é‡: `export GENERATIVE_MODELS_PATH=/path/to/generative-models`

### 2. CUDA å†…å­˜ä¸è¶³

**é—®é¢˜**: ç”Ÿæˆè§†é¢‘æ—¶æ˜¾å­˜ä¸è¶³

**è§£å†³**: 
- åœ¨ `config.yaml` ä¸­å‡å° `num_frames`ï¼ˆå¦‚æ”¹ä¸º 14ï¼‰
- å¯ç”¨ `memory_efficient: true`
- ä½¿ç”¨ `mixed_precision: fp16`

### 3. FFmpeg é”™è¯¯

**é—®é¢˜**: è§†é¢‘åˆæˆå¤±è´¥

**è§£å†³**: 
- ç¡®ä¿å·²å®‰è£… FFmpeg: `sudo apt install ffmpeg`
- æ£€æŸ¥ FFmpeg ç‰ˆæœ¬: `ffmpeg -version`
- æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼Œå¯èƒ½éœ€è¦å®‰è£…å­—å¹•å­—ä½“

### 4. TTS æ¨¡å‹åŠ è½½å¤±è´¥

**é—®é¢˜**: ChatTTS æ— æ³•åŠ è½½

**è§£å†³**: 
- ç¡®ä¿å·²å®‰è£…: `pip install chattts`
- æ¨¡å‹ä¼šåœ¨é¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨ä¸‹è½½
- å¦‚æœç½‘ç»œé—®é¢˜ï¼Œå¯ä»¥æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹

### 5. å­—å¹•ä¸æ˜¾ç¤º

**é—®é¢˜**: åˆæˆè§†é¢‘åå­—å¹•ä¸æ˜¾ç¤º

**è§£å†³**: 
- æ£€æŸ¥å­—å¹•æ–‡ä»¶æ ¼å¼ï¼ˆUTF-8 ç¼–ç ï¼‰
- ç¡®ä¿ç³»ç»Ÿæœ‰æ‰€éœ€å­—ä½“ï¼ˆSimHeiï¼‰
- å°è¯•ä½¿ç”¨å…¶ä»–å­—å¹•æ ¼å¼ï¼ˆvtt æˆ– assï¼‰

## è¾“å‡ºæ–‡ä»¶ç»“æ„

```
outputs/
â””â”€â”€ lingjie_ep2/
    â”œâ”€â”€ videos/              # è§†é¢‘ç‰‡æ®µ
    â”‚   â”œâ”€â”€ scene_001.mp4
    â”‚   â”œâ”€â”€ scene_002.mp4
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ audio.wav            # é…éŸ³
    â”œâ”€â”€ subtitle.srt         # å­—å¹•
    â””â”€â”€ lingjie_ep2.mp4      # æœ€ç»ˆè§†é¢‘
```

## ä¸‹ä¸€æ­¥

1. **å®‰è£… generative-models**: æŒ‰ç…§ README.md ä¸­çš„è¯´æ˜å®‰è£…
2. **ä¸‹è½½æ¨¡å‹**: ä¸‹è½½ SVD æ¨¡å‹å’Œ TTS æ¨¡å‹
3. **æµ‹è¯•å•ä¸ªç»„ä»¶**: å…ˆæµ‹è¯•è§†é¢‘ç”Ÿæˆã€TTSã€å­—å¹•ç”Ÿæˆ
4. **è¿è¡Œå®Œæ•´æµæ°´çº¿**: ä½¿ç”¨ `run_pipeline.py` ç”Ÿæˆå®Œæ•´è§†é¢‘

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ‰¹é‡å¤„ç†**: ä½¿ç”¨æ‰¹é‡æ¨¡å¼ç”Ÿæˆè§†é¢‘ç‰‡æ®µ
2. **GPU åŠ é€Ÿ**: ç¡®ä¿ä½¿ç”¨ CUDA è®¾å¤‡
3. **å†…å­˜ä¼˜åŒ–**: å¯ç”¨å†…å­˜ä¼˜åŒ–é€‰é¡¹
4. **å¹¶è¡Œå¤„ç†**: å¯ä»¥å¹¶è¡Œç”Ÿæˆå¤šä¸ªè§†é¢‘ç‰‡æ®µ

## æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æµ‹è¯•è„šæœ¬è¾“å‡º: `python test_script.py`
2. æ—¥å¿—æ–‡ä»¶: æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
3. é…ç½®æ–‡ä»¶: æ£€æŸ¥ `config.yaml` è®¾ç½®
4. ä¾èµ–å®‰è£…: ç¡®ä¿æ‰€æœ‰ä¾èµ–å·²å®‰è£…

ç¥ä½¿ç”¨æ„‰å¿«ï¼ğŸ¬

