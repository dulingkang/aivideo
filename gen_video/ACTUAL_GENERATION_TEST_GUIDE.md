# v2.2-finalæ ¼å¼å®é™…å›¾åƒç”Ÿæˆæµ‹è¯•æŒ‡å—

> **åˆ›å»ºæ—¥æœŸ**: 2025-12-21  
> **çŠ¶æ€**: âœ… æµ‹è¯•è„šæœ¬å·²å°±ç»ª

---

## ğŸ“‹ æµ‹è¯•è„šæœ¬

### 1. test_v22_actual_generation_simple.pyï¼ˆæ¨èï¼‰

**åŠŸèƒ½**: ç®€åŒ–ç‰ˆå®é™…å›¾åƒç”Ÿæˆæµ‹è¯•

**ç‰¹ç‚¹**:
- ç›´æ¥è°ƒç”¨`NovelVideoGenerator.generate()`
- è‡ªåŠ¨æ£€æµ‹v2.2-finalæ ¼å¼
- è‡ªåŠ¨æŸ¥æ‰¾ç”Ÿæˆçš„å›¾ç‰‡
- æ˜¾ç¤ºå›¾ç‰‡ä¿¡æ¯

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å‰ç½®æ¡ä»¶

1. **æ¿€æ´»condaç¯å¢ƒ**ï¼ˆå¦‚æœä½¿ç”¨condaï¼‰
   ```bash
   conda activate <your_env_name>
   ```

2. **ç¡®ä¿config.yamlå­˜åœ¨**
   ```bash
   ls config.yaml
   # æˆ–
   ls gen_video/config.yaml
   ```

3. **ç¡®ä¿æœ‰GPUèµ„æº**
   - æ£€æŸ¥GPUæ˜¯å¦å¯ç”¨
   - ç¡®ä¿æœ‰è¶³å¤Ÿçš„æ˜¾å­˜

---

### è¿è¡Œæµ‹è¯•

#### æ–¹å¼1: ç›´æ¥è¿è¡Œï¼ˆæ¨èï¼‰

```bash
cd /vepfs-dev/shawn/vid/fanren/gen_video
python3 test_v22_actual_generation_simple.py schemas/scene_v22_real_example.json
```

#### æ–¹å¼2: ä½¿ç”¨proxychains4ï¼ˆå¦‚æœéœ€è¦ä»£ç†ï¼‰

```bash
cd /vepfs-dev/shawn/vid/fanren/gen_video
proxychains4 python3 test_v22_actual_generation_simple.py schemas/scene_v22_real_example.json
```

#### æ–¹å¼3: æŒ‡å®šè¾“å‡ºç›®å½•

```bash
python3 test_v22_actual_generation_simple.py \
  schemas/scene_v22_real_example.json \
  --output-dir outputs/my_test_20251221
```

---

## ğŸ“Š æµ‹è¯•æµç¨‹

### æ­¥éª¤1: JSONéªŒè¯

è„šæœ¬ä¼šè‡ªåŠ¨éªŒè¯JSONæ ¼å¼ï¼š
- âœ… æ£€æŸ¥ç‰ˆæœ¬æ˜¯å¦ä¸º`v2.2-final`
- âœ… éªŒè¯å¿…éœ€å­—æ®µ
- âœ… æ£€æŸ¥å­—æ®µç±»å‹

### æ­¥éª¤2: åˆå§‹åŒ–ç”Ÿæˆå™¨

- æŸ¥æ‰¾`config.yaml`
- åˆå§‹åŒ–`NovelVideoGenerator`
- åˆå§‹åŒ–`ImageGenerator`

### æ­¥éª¤3: å¼€å§‹ç”Ÿæˆ

- è°ƒç”¨`generate()`æ–¹æ³•
- ä½¿ç”¨`ExecutionExecutorV21`å¤„ç†v2.2-finalæ ¼å¼
- ç”Ÿæˆå›¾åƒ

### æ­¥éª¤4: éªŒè¯ç»“æœ

- æŸ¥æ‰¾ç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶
- æ˜¾ç¤ºå›¾ç‰‡ä¿¡æ¯ï¼ˆå°ºå¯¸ã€å¤§å°ç­‰ï¼‰
- ä¿å­˜æµ‹è¯•ç»“æœ

---

## ğŸ“ è¾“å‡ºä½ç½®

### é»˜è®¤è¾“å‡ºç›®å½•

```
outputs/test_v22_actual_scene_v22_real_example_YYYYMMDD_HHMMSS/
â”œâ”€â”€ scene_001/
â”‚   â””â”€â”€ novel_image.png  # ç”Ÿæˆçš„å›¾ç‰‡
â””â”€â”€ scene_v22_real_example.json  # æµ‹è¯•JSON
```

### å›¾ç‰‡è·¯å¾„

ç”Ÿæˆçš„å›¾ç‰‡é€šå¸¸ä½äºï¼š
- `outputs/test_v22_actual_*/scene_001/novel_image.png`
- æˆ– `outputs/test_v22_actual_*/scene_XXX/novel_image.png`ï¼ˆæ ¹æ®scene_idï¼‰

---

## ğŸ” æµ‹è¯•ç»“æœç¤ºä¾‹

### æˆåŠŸè¾“å‡º

```
============================================================
v2.2-finalæ ¼å¼å®é™…å›¾åƒç”Ÿæˆæµ‹è¯•
============================================================

ä½¿ç”¨JSONæ–‡ä»¶: schemas/scene_v22_real_example.json
âœ“ JSONæ–‡ä»¶åŠ è½½æˆåŠŸ

è¾“å‡ºç›®å½•: outputs/test_v22_actual_scene_v22_real_example_20251221_093000

âœ“ æ‰¾åˆ°é…ç½®æ–‡ä»¶: config.yaml
ğŸš€ åˆå§‹åŒ–NovelVideoGenerator...

============================================================
å¼€å§‹ç”Ÿæˆ
============================================================
åœºæ™¯ID: 1
Shot: medium
Pose: sit
Model: flux

ğŸš€ è°ƒç”¨generateæ–¹æ³•...
  âœ“ æ£€æµ‹åˆ°v2.2-finalæ ¼å¼ï¼Œä½¿ç”¨Execution Executor
  ...

âœ“ ç”ŸæˆæˆåŠŸ (è€—æ—¶: 45.23ç§’)
  âœ“ å›¾åƒæ–‡ä»¶: outputs/.../scene_001/novel_image.png
    æ–‡ä»¶å¤§å°: 1234.56 KB
    å›¾ç‰‡å°ºå¯¸: 1024x1024
    å›¾ç‰‡æ¨¡å¼: RGB
```

### å¤±è´¥è¾“å‡º

å¦‚æœç”Ÿæˆå¤±è´¥ï¼Œè„šæœ¬ä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼š

```
âœ— ç”Ÿæˆå¤±è´¥: <é”™è¯¯ä¿¡æ¯>
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### 1. ModuleNotFoundError: No module named 'torch'

**åŸå› **: ç¯å¢ƒæœªæ¿€æ´»æˆ–torchæœªå®‰è£…

**è§£å†³**:
```bash
# æ¿€æ´»condaç¯å¢ƒ
conda activate <env_name>

# æˆ–å®‰è£…torch
pip install torch torchvision
```

---

### 2. æœªæ‰¾åˆ°é…ç½®æ–‡ä»¶

**åŸå› **: `config.yaml`ä¸åœ¨é¢„æœŸä½ç½®

**è§£å†³**:
- æ£€æŸ¥`config.yaml`æ˜¯å¦å­˜åœ¨
- ç¡®ä¿åœ¨æ­£ç¡®çš„ç›®å½•è¿è¡Œè„šæœ¬
- æˆ–ä½¿ç”¨ç»å¯¹è·¯å¾„

---

### 3. GPUä¸å¯ç”¨

**åŸå› **: GPUæœªæ­£ç¡®é…ç½®æˆ–æ˜¾å­˜ä¸è¶³

**è§£å†³**:
- æ£€æŸ¥GPUæ˜¯å¦å¯ç”¨: `nvidia-smi`
- æ£€æŸ¥CUDAæ˜¯å¦æ­£ç¡®å®‰è£…
- è€ƒè™‘ä½¿ç”¨CPUæ¨¡å¼ï¼ˆå¦‚æœæ”¯æŒï¼‰

---

### 4. ç”Ÿæˆå¤±è´¥ä½†æ— é”™è¯¯ä¿¡æ¯

**åŸå› **: å¯èƒ½æ˜¯ç”Ÿæˆè¿‡ç¨‹ä¸­çš„å†…éƒ¨é”™è¯¯

**è§£å†³**:
- æ£€æŸ¥æ—¥å¿—è¾“å‡º
- æŸ¥çœ‹`ExecutionExecutorV21`çš„é”™è¯¯ä¿¡æ¯
- æ£€æŸ¥JSONæ ¼å¼æ˜¯å¦æ­£ç¡®

---

## ğŸ“ æµ‹è¯•JSONæ–‡ä»¶

### scene_v22_real_example.json

**åœºæ™¯**: éŸ©ç«‹åœ¨é»„æ«è°·ä¿®ç‚¼

**é…ç½®**:
- Shot: mediumï¼ˆä¸­æ™¯ï¼‰
- Pose: sitï¼ˆç›˜åä¿®ç‚¼ï¼‰
- Model: flux + pulid
- Character: hanliï¼ˆéŸ©ç«‹ï¼‰

### scene_v22_real_example_002.json

**åœºæ™¯**: éŸ©ç«‹æˆ˜æ–—åœºæ™¯

**é…ç½®**:
- Shot: mediumï¼ˆä¸­æ™¯ï¼‰
- Pose: standï¼ˆæˆ˜æ–—å§¿æ€ï¼‰
- Model: flux + pulid

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

- `test_v22_actual_generation_simple.py` - ç®€åŒ–ç‰ˆæµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰
- `test_v22_actual_generation.py` - å®Œæ•´ç‰ˆæµ‹è¯•è„šæœ¬
- `schemas/scene_v22_real_example.json` - æµ‹è¯•JSONæ–‡ä»¶1
- `schemas/scene_v22_real_example_002.json` - æµ‹è¯•JSONæ–‡ä»¶2
- `generate_novel_video.py` - ä¸»ç”Ÿæˆè„šæœ¬
- `utils/execution_executor_v21.py` - v2.1/v2.2æ‰§è¡Œå™¨

---

## ğŸ’¡ æç¤º

1. **é¦–æ¬¡è¿è¡Œ**: å»ºè®®å…ˆæµ‹è¯•å•ä¸ªåœºæ™¯ï¼Œç¡®è®¤ç¯å¢ƒé…ç½®æ­£ç¡®
2. **æ‰¹é‡æµ‹è¯•**: å¯ä»¥ä¿®æ”¹è„šæœ¬æ”¯æŒæ‰¹é‡æµ‹è¯•å¤šä¸ªJSONæ–‡ä»¶
3. **æ€§èƒ½ä¼˜åŒ–**: å¦‚æœç”Ÿæˆé€Ÿåº¦æ…¢ï¼Œå¯ä»¥è°ƒæ•´`generation_params`ä¸­çš„æ­¥æ•°
4. **è°ƒè¯•æ¨¡å¼**: å¯ä»¥æ·»åŠ `--debug`å‚æ•°æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

---

## ğŸ“ ä¸‹ä¸€æ­¥

æµ‹è¯•æˆåŠŸåï¼Œå¯ä»¥ï¼š

1. **æ‰¹é‡ç”Ÿæˆ**: ä½¿ç”¨å¤šä¸ªJSONæ–‡ä»¶è¿›è¡Œæ‰¹é‡æµ‹è¯•
2. **ä¼˜åŒ–å‚æ•°**: æ ¹æ®ç”Ÿæˆç»“æœè°ƒæ•´JSONä¸­çš„å‚æ•°
3. **é›†æˆåˆ°ä¸»æµç¨‹**: å°†v2.2-finalæ ¼å¼é›†æˆåˆ°å®é™…ç”Ÿäº§æµç¨‹

