# æ–¹æ¡ˆBï¼šå›½æ¼«æ’å›¾ + é•œå¤´è¿åŠ¨ å®ç°å‚è€ƒä¸ä¼˜åŒ–å»ºè®®

## ğŸ“Š å½“å‰ç³»ç»Ÿ vs æ–¹æ¡ˆBæœ€ä½³å®è·µ

### âœ… å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½ | å½“å‰å®ç° | çŠ¶æ€ |
|------|---------|------|
| **InstantID + LoRA** | âœ… è§’è‰²ä¸€è‡´æ€§ | å®Œæ•´ |
| **é£æ ¼LoRA** | âœ… å›½æ¼«é£æ ¼ | å®Œæ•´ |
| **åœºæ™¯å‚è€ƒå›¾åƒ** | âœ… ä»åŸç´ æå­¦ä¹  | å®Œæ•´ |
| **img2img** | âœ… ç»“æ„è¿è´¯æ€§ | å®Œæ•´ |
| **SVDå›¾ç”Ÿè§†é¢‘** | âœ… è¿åŠ¨åŒ– | å®Œæ•´ |
| **é™æ€å›¾åƒåŠ¨ç”»** | âœ… Ken Burnsæ•ˆæœ | åŸºç¡€ |
| **è¶…åˆ†** | âœ… RealESRGAN | å®Œæ•´ |
| **TTS** | âœ… CosyVoice | å®Œæ•´ |
| **å­—å¹•** | âœ… WhisperX | å®Œæ•´ |

### âš ï¸ å¯ä¼˜åŒ–çš„éƒ¨åˆ†

| åŠŸèƒ½ | å½“å‰å®ç° | å¯ä¼˜åŒ–ä¸º |
|------|---------|---------|
| **é•œå¤´è¿åŠ¨** | åŸºç¡€Ken Burns | Deforumé£æ ¼å‚æ•°åŒ–è¿åŠ¨ |
| **è¿åŠ¨æ¨¡å¼** | ç®€å•zoom | zoom/pan/rotateç»„åˆ |
| **å…³é”®å¸§æ§åˆ¶** | æ—  | æ”¯æŒå…³é”®å¸§åŠ¨ç”» |
| **è¿åŠ¨æ›²çº¿** | çº¿æ€§ | ease_in_outç­‰ |

## ğŸ¯ å¯å‚è€ƒçš„å®ç°

### 1. ComfyUI Deforumï¼ˆæœ€æ¨èï¼‰â­â­â­â­â­

**GitHub**ï¼š
- https://github.com/volotat/ComfyUI-Deforum
- https://github.com/deforum-art/deforum-for-automatic1111-webui

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- å‚æ•°åŒ–ç›¸æœºè¿åŠ¨ï¼ˆzoomã€panã€rotateï¼‰
- å…³é”®å¸§æ§åˆ¶
- å¤šç§è¿åŠ¨æ›²çº¿
- æ”¯æŒSDXLå’ŒSD1.5

**å…³é”®å‚æ•°ç¤ºä¾‹**ï¼š
```python
# Deforumé£æ ¼çš„ç›¸æœºè¿åŠ¨å‚æ•°
camera_motion = {
    "zoom": {
        "start": 1.0,
        "end": 1.1,  # è½»å¾®æ”¾å¤§
        "curve": "ease_in_out"
    },
    "pan_x": {
        "start": 0.0,
        "end": 0.05,  # è½»å¾®å³ç§»
        "curve": "linear"
    },
    "pan_y": {
        "start": 0.0,
        "end": 0.0,
        "curve": "linear"
    },
    "rotate": {
        "start": 0.0,
        "end": 0.0,
        "curve": "linear"
    }
}
```

**é›†æˆå»ºè®®**ï¼š
- å¯ä»¥åŸºäºå½“å‰`_generate_static_image_animation`æ‰©å±•
- æ·»åŠ Deforumé£æ ¼çš„å‚æ•°åŒ–ç›¸æœºè¿åŠ¨
- æ”¯æŒä»åœºæ™¯æè¿°è‡ªåŠ¨æ¨æ–­è¿åŠ¨å‚æ•°

### 2. AniSora V3ï¼ˆBilibiliå¼€æºï¼‰â­â­â­â­

**ç‰¹ç‚¹**ï¼š
- ä¸“ä¸ºåŠ¨æ¼«è§†é¢‘ç”Ÿæˆè®¾è®¡
- æ”¯æŒä»å•å¼ å›¾åƒç”ŸæˆåŠ¨æ€è§†é¢‘
- ä¿æŒè§’è‰²ç»†èŠ‚å’Œé£æ ¼ä¸€è‡´

**GitHub**ï¼š
- æœç´¢"AniSora"æˆ–"Bilibili AniSora"

**å‚è€ƒä»·å€¼**ï¼š
- åŠ¨æ¼«é£æ ¼è§†é¢‘ç”Ÿæˆçš„æœ€ä½³å®è·µ
- è§’è‰²ä¸€è‡´æ€§ä¿æŒæ–¹æ³•
- é£æ ¼è¿ç§»æŠ€æœ¯

### 3. ToonCrafter / PhysAnimatorï¼ˆå­¦æœ¯ç ”ç©¶ï¼‰

**ç‰¹ç‚¹**ï¼š
- ç”Ÿæˆå¼å¡é€šæ’å€¼
- ç‰©ç†å¼•å¯¼çš„åŠ¨ç”»ç”Ÿæˆ
- é€‚åˆé™æ€æ’ç”»åŠ¨ç”»åŒ–

**å‚è€ƒä»·å€¼**ï¼š
- åŠ¨ç”»ç”Ÿæˆçš„ç†è®ºåŸºç¡€
- è¿åŠ¨æ’å€¼æ–¹æ³•
- é£æ ¼ä¿æŒæŠ€æœ¯

### 4. Runway Gen-2 / Pika Labsï¼ˆå•†ä¸šæ–¹æ¡ˆï¼‰

**ç‰¹ç‚¹**ï¼š
- æœ€åƒäºŒç»´åŠ¨ç”»çš„å›¾ç”Ÿè§†é¢‘
- æ”¯æŒé•œå¤´è¿åŠ¨æ§åˆ¶
- å•†ä¸šAPIå¯ç”¨

**å‚è€ƒä»·å€¼**ï¼š
- å¦‚æœé¢„ç®—å…è®¸ï¼Œå¯ä»¥è€ƒè™‘APIè°ƒç”¨
- äº†è§£å•†ä¸šæ–¹æ¡ˆçš„æœ€ä½³å®è·µ

## ğŸ’¡ ä¼˜åŒ–å»ºè®®ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

### ä¼˜å…ˆçº§1ï¼šå¢å¼ºé™æ€å›¾åƒåŠ¨ç”»ï¼ˆå¿«é€Ÿè§æ•ˆï¼‰â­â­â­â­â­

**å½“å‰å®ç°**ï¼šç®€å•çš„Ken Burnsæ•ˆæœï¼ˆè½»å¾®zoomï¼‰

**å¯ä¼˜åŒ–ä¸º**ï¼š
```python
def apply_deforum_camera_motion(image, num_frames, fps, scene=None):
    """
    åº”ç”¨Deforumé£æ ¼çš„å‚æ•°åŒ–ç›¸æœºè¿åŠ¨
    """
    # æ ¹æ®åœºæ™¯ç±»å‹è‡ªåŠ¨é€‰æ‹©è¿åŠ¨æ¨¡å¼
    if scene:
        motion_type = scene.get('visual', {}).get('motion', {}).get('type', 'static')
        camera = scene.get('camera', '').lower()
        
        # æ ¹æ®åœºæ™¯ç±»å‹è®¾ç½®è¿åŠ¨å‚æ•°
        if 'zoom' in motion_type or 'dolly' in camera:
            # ç¼©æ”¾è¿åŠ¨
            zoom_start = 1.0
            zoom_end = 1.15  # è½»å¾®æ”¾å¤§
        elif 'pan' in motion_type or 'tilt' in camera:
            # å¹³ç§»è¿åŠ¨
            zoom_start = 1.0
            zoom_end = 1.0
            pan_x_start = 0.0
            pan_x_end = 0.1  # æ ¹æ®æ–¹å‘è°ƒæ•´
        else:
            # é»˜è®¤è½»å¾®zoom
            zoom_start = 1.0
            zoom_end = 1.1
    
    # åº”ç”¨å‚æ•°åŒ–è¿åŠ¨
    frames = []
    for i in range(num_frames):
        t = i / (num_frames - 1)  # 0.0 to 1.0
        
        # ä½¿ç”¨ease_in_outæ›²çº¿
        t_eased = t * t * (3.0 - 2.0 * t)  # smoothstep
        
        # æ’å€¼å‚æ•°
        zoom = zoom_start + (zoom_end - zoom_start) * t_eased
        pan_x = pan_x_start + (pan_x_end - pan_x_start) * t_eased
        pan_y = pan_y_start + (pan_y_end - pan_y_start) * t_eased
        rotate = rotate_start + (rotate_end - rotate_start) * t_eased
        
        # åº”ç”¨å˜æ¢
        frame = apply_camera_transform(image, zoom, pan_x, pan_y, rotate)
        frames.append(frame)
    
    return frames
```

**ä¼˜åŠ¿**ï¼š
- å¿«é€Ÿå®ç°ï¼Œæ— éœ€è®­ç»ƒ
- æ˜¾è‘—æå‡åŠ¨ç”»æ„Ÿ
- å¯æ ¹æ®åœºæ™¯è‡ªåŠ¨é€‰æ‹©è¿åŠ¨æ¨¡å¼

### ä¼˜å…ˆçº§2ï¼šæ ¹æ®åœºæ™¯ç±»å‹è‡ªåŠ¨é€‰æ‹©è¿åŠ¨æ¨¡å¼ â­â­â­â­

**å®ç°**ï¼š
```python
def select_camera_motion_from_scene(scene):
    """
    æ ¹æ®åœºæ™¯ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä½³è¿åŠ¨æ¨¡å¼
    """
    motion_type = scene.get('visual', {}).get('motion', {}).get('type', 'static')
    camera = scene.get('camera', '').lower()
    composition = scene.get('visual', {}).get('composition', '').lower()
    
    # è¿œæ™¯åœºæ™¯ â†’ ç¼“æ…¢zoom in
    if 'wide' in composition or 'distant' in composition:
        return {
            "zoom": {"start": 1.0, "end": 1.2},
            "pan_x": {"start": 0.0, "end": 0.0},
            "pan_y": {"start": 0.0, "end": 0.0},
            "rotate": {"start": 0.0, "end": 0.0}
        }
    
    # ä¸­æ™¯åœºæ™¯ â†’ è½»å¾®pan
    elif 'medium' in composition or 'mid' in composition:
        return {
            "zoom": {"start": 1.0, "end": 1.0},
            "pan_x": {"start": 0.0, "end": 0.05},
            "pan_y": {"start": 0.0, "end": 0.0},
            "rotate": {"start": 0.0, "end": 0.0}
        }
    
    # ç‰¹å†™åœºæ™¯ â†’ é™æ€æˆ–è½»å¾®zoom
    elif 'close' in composition or 'close-up' in composition:
        return {
            "zoom": {"start": 1.0, "end": 1.05},
            "pan_x": {"start": 0.0, "end": 0.0},
            "pan_y": {"start": 0.0, "end": 0.0},
            "rotate": {"start": 0.0, "end": 0.0}
        }
    
    # é»˜è®¤ï¼šè½»å¾®zoom
    else:
        return {
            "zoom": {"start": 1.0, "end": 1.1},
            "pan_x": {"start": 0.0, "end": 0.0},
            "pan_y": {"start": 0.0, "end": 0.0},
            "rotate": {"start": 0.0, "end": 0.0}
        }
```

### ä¼˜å…ˆçº§3ï¼šä¼˜åŒ–SVDå‚æ•°ï¼ˆæ ¹æ®åœºæ™¯ç±»å‹ï¼‰â­â­â­

**å½“å‰**ï¼šæ ¹æ®åœºæ™¯ç±»å‹è‡ªåŠ¨è°ƒæ•´motion_bucket_id

**å¯è¿›ä¸€æ­¥ä¼˜åŒ–**ï¼š
- äººç‰©åœºæ™¯ â†’ é™ä½motion_bucket_idï¼ˆ1.5-1.8ï¼‰
- ç¯å¢ƒåœºæ™¯ â†’ æé«˜motion_bucket_idï¼ˆ1.8-2.0ï¼‰
- ç‰©ä½“è¿åŠ¨ â†’ ä¸­ç­‰motion_bucket_idï¼ˆ1.6-1.9ï¼‰

## ğŸ“š å…·ä½“å‚è€ƒèµ„æº

### 1. ComfyUI Deforumä»£ç å‚è€ƒ

**å…³é”®æ–‡ä»¶**ï¼š
- `deforum_nodes.py` - èŠ‚ç‚¹å®šä¹‰
- `deforum_helpers.py` - è¾…åŠ©å‡½æ•°
- `deforum_animation.py` - åŠ¨ç”»é€»è¾‘

**å…³é”®å‡½æ•°**ï¼š
```python
# ç›¸æœºè¿åŠ¨è®¡ç®—
def calculate_camera_motion(frame, zoom, pan_x, pan_y, rotate):
    # åº”ç”¨zoomã€panã€rotateå˜æ¢
    pass

# å…³é”®å¸§æ’å€¼
def interpolate_keyframes(keyframes, frame):
    # ä½¿ç”¨ease_in_outç­‰æ›²çº¿æ’å€¼
    pass
```

### 2. AniSora V3å‚è€ƒ

**å…³é”®ç‰¹æ€§**ï¼š
- ä»å•å¼ å›¾åƒç”ŸæˆåŠ¨æ€è§†é¢‘
- ä¿æŒè§’è‰²ç»†èŠ‚å’Œé£æ ¼ä¸€è‡´
- æ”¯æŒå¤šç§åŠ¨æ¼«é£æ ¼

**å‚è€ƒä»·å€¼**ï¼š
- äº†è§£åŠ¨æ¼«è§†é¢‘ç”Ÿæˆçš„æœ€ä½³å®è·µ
- è§’è‰²ä¸€è‡´æ€§ä¿æŒæ–¹æ³•

### 3. ç›¸å…³è®ºæ–‡

- **ToonCrafter**: ç”Ÿæˆå¼å¡é€šæ’å€¼
- **PhysAnimator**: ç‰©ç†å¼•å¯¼çš„ç”Ÿæˆå¼å¡é€šåŠ¨ç”»
- **Cartoondiff**: åŸºäºæ‰©æ•£å˜æ¢å™¨çš„æ— è®­ç»ƒå¡é€šå›¾åƒç”Ÿæˆ

## ğŸ¯ å®æ–½è·¯çº¿å›¾

### é˜¶æ®µ1ï¼šå¢å¼ºé™æ€å›¾åƒåŠ¨ç”»ï¼ˆ1-2å¤©ï¼‰

1. **å‚è€ƒDeforumå®ç°**ï¼š
   - æ·»åŠ zoomã€panã€rotateå‚æ•°
   - æ”¯æŒå…³é”®å¸§æ§åˆ¶
   - å¤šç§è¿åŠ¨æ›²çº¿

2. **æ ¹æ®åœºæ™¯è‡ªåŠ¨é€‰æ‹©**ï¼š
   - è¿œæ™¯ â†’ zoom in
   - ä¸­æ™¯ â†’ pan
   - ç‰¹å†™ â†’ é™æ€æˆ–è½»å¾®zoom

### é˜¶æ®µ2ï¼šä¼˜åŒ–SVDå‚æ•°ï¼ˆ1å¤©ï¼‰

1. **æ ¹æ®åœºæ™¯ç±»å‹è°ƒæ•´**ï¼š
   - äººç‰©åœºæ™¯ â†’ é™ä½motion_bucket_id
   - ç¯å¢ƒåœºæ™¯ â†’ æé«˜motion_bucket_id
   - ç‰©ä½“è¿åŠ¨ â†’ ä¸­ç­‰motion_bucket_id

2. **æ·»åŠ æ›´å¤šè¿åŠ¨æ¨¡å¼**ï¼š
   - æ”¯æŒå¤šç§motion_bucket_id
   - æ ¹æ®åœºæ™¯æè¿°è‡ªåŠ¨é€‰æ‹©

### é˜¶æ®µ3ï¼šè€ƒè™‘å•†ä¸šæ–¹æ¡ˆï¼ˆå¯é€‰ï¼‰

1. **Runway Gen-2 API**ï¼š
   - å¦‚æœé¢„ç®—å…è®¸
   - æ•ˆæœæœ€æ¥è¿‘äºŒç»´åŠ¨ç”»

2. **Pika Labs API**ï¼š
   - åŠ¨ç”»é£æ ¼
   - é•œå¤´è¿åŠ¨æ§åˆ¶

## ğŸ“Š å½“å‰ç³»ç»Ÿè¯„ä¼°

### ä¼˜åŠ¿ âœ…

1. **å®Œæ•´çš„æµç¨‹**ï¼šä»æ–‡å­—åˆ°è§†é¢‘å…¨æµç¨‹
2. **è§’è‰²ä¸€è‡´æ€§**ï¼šInstantID + LoRA
3. **é£æ ¼æ§åˆ¶**ï¼šé£æ ¼LoRA + åœºæ™¯å‚è€ƒ
4. **è´¨é‡ç¨³å®š**ï¼šSVDç»è¿‡éªŒè¯

### å¯æ”¹è¿› âš ï¸

1. **é•œå¤´è¿åŠ¨**ï¼šå¯å‚è€ƒDeforumå¢å¼º
2. **åŠ¨ç”»åŒ–**ï¼šå¯æ·»åŠ æ›´å¤šè¿åŠ¨æ¨¡å¼
3. **å‚æ•°æ§åˆ¶**ï¼šå¯æ·»åŠ å…³é”®å¸§æ§åˆ¶

## ğŸ’¬ ç»“è®º

**å½“å‰ç³»ç»Ÿå·²ç»å®ç°äº†æ–¹æ¡ˆBçš„æ ¸å¿ƒéƒ¨åˆ†**ï¼Œä½†å¯ä»¥ï¼š

1. **å‚è€ƒComfyUI Deforum**ï¼šå¢å¼ºç›¸æœºè¿åŠ¨ï¼ˆæœ€æ¨èï¼‰
2. **ä¼˜åŒ–å‚æ•°æ§åˆ¶**ï¼šæ·»åŠ å…³é”®å¸§å’Œè¿åŠ¨æ›²çº¿
3. **æ ¹æ®åœºæ™¯è‡ªåŠ¨é€‰æ‹©**ï¼šæœ€ä½³è¿åŠ¨æ¨¡å¼

**å»ºè®®ä¼˜å…ˆå®æ–½**ï¼š
- å¢å¼ºé™æ€å›¾åƒåŠ¨ç”»ï¼ˆå‚è€ƒDeforumï¼‰
- æ ¹æ®åœºæ™¯ç±»å‹è‡ªåŠ¨é€‰æ‹©è¿åŠ¨æ¨¡å¼
- ä¼˜åŒ–SVDå‚æ•°ï¼ˆæ ¹æ®åœºæ™¯ç±»å‹ï¼‰

è¿™æ ·å¯ä»¥åœ¨ä¸æ”¹å˜æ ¸å¿ƒæ¶æ„çš„æƒ…å†µä¸‹ï¼Œæ˜¾è‘—æå‡è§†é¢‘è´¨é‡å’ŒåŠ¨ç”»æ„Ÿã€‚

