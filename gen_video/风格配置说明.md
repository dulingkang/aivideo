# 风格配置说明

## 概述

风格系统支持在**配置文件**、**脚本JSON**和**前端API**中配置，实现灵活的样式控制。

## 配置方式

### 1. 配置文件（config.yaml）

在 `hunyuanvideo.style_templates` 中定义风格模板：

```yaml
hunyuanvideo:
  style_templates:
    scientific:
      keywords: ["realistic", "scientific", "educational", "professional", "cinematic"]
      description: "realistic scientific visualization style"
      negative_keywords: ["cartoon", "anime", "fantasy", "illustration"]
    commercial:
      keywords: ["professional", "commercial", "product photography", "clean", "modern"]
      description: "professional commercial product photography style"
      negative_keywords: ["low quality", "blurry", "amateur"]
    # ... 其他风格
  default_style: realistic  # 默认风格
```

### 2. 脚本JSON中配置

在场景的 `visual.style` 或 `style` 字段中指定：

```json
{
  "id": 1,
  "narration": "这是科普场景",
  "visual": {
    "composition": "wide shot of black hole",
    "style": "scientific"  // 使用科普风格
  }
}
```

或者：

```json
{
  "id": 1,
  "narration": "这是产品广告",
  "style": "commercial",  // 直接在场景级别指定
  "visual": {
    "composition": "product shot"
  }
}
```

### 3. 前端API配置

前端可以通过API传递风格参数：

```json
{
  "scene": {
    "description": "a beautiful landscape",
    "visual": {
      "style": "realistic"  // 前端选择风格
    }
  }
}
```

## 支持的风格类型

### scientific（科普/教育）
- **用途**: 政府/教育赛道，科普视频
- **特点**: 写实、科学、专业、电影级
- **适用场景**: 科普讲解、教育内容、政府宣传

### commercial（产品广告）
- **用途**: 电商赛道，产品推广
- **特点**: 专业、商业、现代、高质量
- **适用场景**: 产品广告、电商视频、商业宣传

### dramatic（戏剧/情感）
- **用途**: 短剧推文，情感内容
- **特点**: 电影级、戏剧性、情感化、氛围感
- **适用场景**: 短剧、小说推文、情感故事

### realistic（写实）
- **用途**: 通用写实风格
- **特点**: 写实、专业、高质量、细节丰富
- **适用场景**: 通用场景，默认风格

### xianxia（仙侠）
- **用途**: 仙侠/古风内容（保留兼容性）
- **特点**: 中国动画风格、古代中国奇幻
- **适用场景**: 仙侠小说、古风内容

## 优先级

风格应用的优先级（从高到低）：

1. **脚本中的 `visual.style`** - 最高优先级
2. **脚本中的 `style`** - 次优先级
3. **配置文件中的 `default_style`** - 默认值

## 示例

### 示例1：科普视频

```json
{
  "scenes": [
    {
      "id": 1,
      "narration": "黑洞是宇宙中最神秘的天体",
      "description": "a black hole in space",
      "visual": {
        "style": "scientific",  // 使用科普风格
        "composition": "wide shot"
      }
    }
  ]
}
```

生成的prompt会包含：`"realistic scientific visualization style, a black hole in space, wide shot"`

### 示例2：产品广告

```json
{
  "scenes": [
    {
      "id": 1,
      "narration": "这款智能水杯采用最新科技",
      "description": "a smart water bottle",
      "style": "commercial",  // 使用商业风格
      "visual": {
        "composition": "product shot"
      }
    }
  ]
}
```

生成的prompt会包含：`"professional commercial product photography style, a smart water bottle, product shot"`

## 扩展风格

如需添加新风格，在 `config.yaml` 中添加：

```yaml
hunyuanvideo:
  style_templates:
    your_custom_style:
      keywords: ["keyword1", "keyword2", "keyword3"]
      description: "your style description"
      negative_keywords: ["unwanted1", "unwanted2"]
```

然后在脚本中使用：`"style": "your_custom_style"`

## API接口

### 获取可用风格列表

```bash
GET /api/v1/styles
```

返回所有可用的风格模板信息。

### 在视频生成API中使用风格

```json
{
  "scenes": [
    {
      "prompt": "a beautiful landscape",
      "duration": 5.0,
      "style": "scientific",  // 直接在场景中指定风格
      "visual": {
        "style": "scientific",  // 或在visual中指定
        "composition": "wide shot"
      }
    }
  ]
}
```

## 注意事项

1. 风格名称必须与 `style_templates` 中的键名完全匹配
2. 如果指定的风格不存在，会回退到 `default_style`
3. 风格关键词会自动添加到prompt的前面，影响整体生成效果
4. 建议根据业务场景选择合适的风格，以获得最佳效果
5. 可以通过 `GET /api/v1/styles` 接口获取所有可用风格列表
6. 使用 `python gen_video/utils/style_validator.py` 可以验证风格配置是否正确

