# è§†é¢‘ç”Ÿæˆæµç¨‹åˆ†ææ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£åˆ—è¡¨

æˆ‘å·²ç»ä¸ºæ‚¨åˆ›å»ºäº†ä»¥ä¸‹æ–‡æ¡£å’Œå·¥å…·ï¼Œå¸®åŠ©æ‚¨åˆ†æå’Œæ’æŸ¥é—®é¢˜ï¼š

### 1. **æµç¨‹æ£€æŸ¥æ¸…å•.md**
å®Œæ•´çš„æµç¨‹æ­¥éª¤æ£€æŸ¥æ¸…å•ï¼ŒåŒ…å«ï¼š
- 6 ä¸ªä¸»è¦æ­¥éª¤çš„è¯¦ç»†æ£€æŸ¥ç‚¹
- æ¯ä¸ªæ­¥éª¤çš„è°ƒè¯•å‘½ä»¤
- å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
- å…³é”®é…ç½®æ£€æŸ¥

### 2. **é—®é¢˜æ’æŸ¥æŒ‡å—.md**
é’ˆå¯¹å½“å‰é—®é¢˜çš„è¯¦ç»†æ’æŸ¥æŒ‡å—ï¼š
- é—®é¢˜æè¿°å’Œè¯Šæ–­ç»“æœ
- å¯èƒ½çš„åŸå› åˆ†æ
- é€æ­¥è§£å†³æ–¹æ¡ˆ
- å¸¸è§é—®é¢˜ FAQ

### 3. **diagnose.py**
å¿«é€Ÿè¯Šæ–­è„šæœ¬ï¼Œæ£€æŸ¥ï¼š
- TTS é…ç½®ï¼ˆå¼•æ“ã€è¯­é€Ÿã€é£æ ¼ï¼‰
- BGM é…ç½®ï¼ˆå¯ç”¨çŠ¶æ€ã€æ–‡ä»¶è·¯å¾„ï¼‰
- ç”Ÿæˆçš„æ–‡ä»¶ï¼ˆéŸ³é¢‘ã€å­—å¹•ã€è§†é¢‘ï¼‰
- TTS å¼•æ“å®é™…åŠ è½½æƒ…å†µ

### 4. **regenerate_audio.sh**
ä¸€é”®é‡æ–°ç”Ÿæˆè„šæœ¬ï¼Œè‡ªåŠ¨æ‰§è¡Œï¼š
- æ¸…ç†æ—§æ–‡ä»¶
- é‡æ–°ç”Ÿæˆé…éŸ³
- é‡æ–°ç”Ÿæˆå­—å¹•
- é‡æ–°åˆæˆè§†é¢‘

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³• 1: ä½¿ç”¨è¯Šæ–­è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
source /vepfs-dev/shawn/venv/py312/bin/activate
cd /vepfs-dev/shawn/vid/fanren/gen_video

# è¿è¡Œè¯Šæ–­
python diagnose.py lingjie_ep5_auto_v2
```

### æ–¹æ³• 2: ä½¿ç”¨ä¸€é”®é‡æ–°ç”Ÿæˆè„šæœ¬

```bash
source /vepfs-dev/shawn/venv/py312/bin/activate
cd /vepfs-dev/shawn/vid/fanren/gen_video

# é‡æ–°ç”ŸæˆéŸ³é¢‘ã€å­—å¹•å’Œè§†é¢‘
./regenerate_audio.sh lingjie_ep5_auto_v2
```

### æ–¹æ³• 3: æ‰‹åŠ¨åˆ†æ­¥æ‰§è¡Œ

```bash
source /vepfs-dev/shawn/venv/py312/bin/activate
cd /vepfs-dev/shawn/vid/fanren/gen_video

# æ­¥éª¤ 1: åˆ é™¤æ—§æ–‡ä»¶
rm -f outputs/lingjie_ep5_auto_v2/audio.wav
rm -f outputs/lingjie_ep5_auto_v2/subtitle.srt

# æ­¥éª¤ 2: é‡æ–°ç”Ÿæˆé…éŸ³
python run_pipeline.py \
  --markdown ../lingjie/5.md \
  --image-dir ../lingjie/img2 \
  --output lingjie_ep5_auto_v2 \
  --skip-image --skip-video --skip-subtitle --skip-compose

# æ­¥éª¤ 3: é‡æ–°ç”Ÿæˆå­—å¹•
python run_pipeline.py \
  --markdown ../lingjie/5.md \
  --image-dir ../lingjie/img2 \
  --output lingjie_ep5_auto_v2 \
  --skip-image --skip-video --skip-tts --skip-compose

# æ­¥éª¤ 4: é‡æ–°åˆæˆè§†é¢‘
python run_pipeline.py \
  --markdown ../lingjie/5.md \
  --image-dir ../lingjie/img2 \
  --output lingjie_ep5_auto_v2 \
  --skip-image --skip-video --skip-tts --skip-subtitle
```

## ğŸ“Š å®Œæ•´æµç¨‹æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. è§£æè„šæœ¬                                                 â”‚
â”‚     - è¾“å…¥: markdown æ–‡ä»¶                                    â”‚
â”‚     - è¾“å‡º: script.jsonï¼ˆåŒ…å«åœºæ™¯ã€æ—ç™½ã€å¼€å¤´ã€ç»“å°¾ï¼‰        â”‚
â”‚     - æ£€æŸ¥: åœºæ™¯æ•°ã€æ—ç™½æ–‡æœ¬ã€å¼€å¤´/ç»“å°¾åœºæ™¯ï¼ˆid=0/999ï¼‰     â”‚
â”‚     - æ¨¡å‹: æ— ï¼ˆçº¯æ–‡æœ¬è§£æï¼‰                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ç”Ÿæˆ/ç¡®ä¿åœºæ™¯å›¾åƒï¼ˆå¯é€‰ï¼‰                                â”‚
â”‚     - è¾“å…¥: åœºæ™¯æè¿°ã€è„šæœ¬ JSON                              â”‚
â”‚     - è¾“å‡º: scene_*.png                                      â”‚
â”‚     - æ£€æŸ¥: ç¼ºå¤±å›¾åƒã€LoRA ä½¿ç”¨ã€å›¾åƒè´¨é‡                    â”‚
â”‚     - æ¨¡å‹:                                                 â”‚
â”‚       â€¢ Stable Diffusion XL (SDXL)                          â”‚
â”‚       â€¢ LoRA: hanli (è§’è‰²å®šåˆ¶)                              â”‚
â”‚       â€¢ IP-Adapter (å›¾åƒå‚è€ƒ)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ç”Ÿæˆåˆ†æ®µé…éŸ³ âš ï¸ å…³é”®æ­¥éª¤ï¼ˆä¼˜åŒ–ï¼šç²¾ç¡®æ—¶é•¿åŒ¹é…ï¼‰          â”‚
â”‚     - è¾“å…¥: åˆ†æ®µæ—ç™½æ–‡æœ¬ï¼ˆå¼€å¤´ã€åœºæ™¯ã€ç»“å°¾ï¼‰                 â”‚
â”‚     - è¾“å‡º: audio_opening.wav, audio_scene_*.wav,          â”‚
â”‚            audio_ending.wavï¼ˆæ¯ä¸ªåœºæ™¯ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼‰         â”‚
â”‚     - æ£€æŸ¥: å¼•æ“ï¼ˆchatttsï¼‰ã€å¥³å£°ã€è¯­é€Ÿã€å†…å®¹                â”‚
â”‚     - æ¨¡å‹:                                                 â”‚
â”‚       â€¢ ChatTTS (æ–‡æœ¬è½¬è¯­éŸ³)                                 â”‚
â”‚     - ä¼˜åŠ¿: ç²¾ç¡®è·å–æ¯ä¸ªç‰‡æ®µçš„å®é™…éŸ³é¢‘æ—¶é•¿ï¼Œæ— éœ€è¯†åˆ«         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. è·å–ç²¾ç¡®éŸ³é¢‘æ—¶é•¿                                         â”‚
â”‚     - è¾“å…¥: åˆ†æ®µéŸ³é¢‘æ–‡ä»¶åˆ—è¡¨                                 â”‚
â”‚     - è¾“å‡º: éŸ³é¢‘æ—¶é•¿åˆ—è¡¨ï¼ˆç²¾ç¡®åˆ°æ¯«ç§’ï¼‰                       â”‚
â”‚     - æ£€æŸ¥: æ¯ä¸ªéŸ³é¢‘æ–‡ä»¶çš„æ—¶é•¿                               â”‚
â”‚     - å·¥å…·: FFmpeg / soundfile                              â”‚
â”‚     - ç”¨é€”: ç”¨äºè§†é¢‘ç”Ÿæˆï¼Œç¡®ä¿è§†é¢‘ä¸éŸ³é¢‘ç²¾ç¡®åŒ¹é…             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. ç”Ÿæˆè§†é¢‘ç‰‡æ®µï¼ˆä½¿ç”¨ç²¾ç¡®éŸ³é¢‘æ—¶é•¿ï¼‰                         â”‚
â”‚     - è¾“å…¥: å›¾åƒæ–‡ä»¶ + ç²¾ç¡®éŸ³é¢‘æ—¶é•¿                          â”‚
â”‚     - è¾“å‡º: scene_*.mp4ï¼ˆæ—¶é•¿ç²¾ç¡®åŒ¹é…éŸ³é¢‘ï¼‰                  â”‚
â”‚     - æ£€æŸ¥: è§†é¢‘æ•°é‡ã€æ—¶é•¿åŒ¹é…ï¼ˆè¯¯å·® < 0.05sï¼‰               â”‚
â”‚     - æ¨¡å‹:                                                 â”‚
â”‚       â€¢ Stable Video Diffusion XT (SVD-XT)                  â”‚
â”‚     - ç‰¹ç‚¹: é€šè¿‡ num_frames = round(duration * fps) è®¡ç®—    â”‚
â”‚            ç²¾ç¡®å¸§æ•°ï¼Œå®ç°è§†é¢‘ä¸éŸ³é¢‘å®Œå…¨åŒæ­¥                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. æ·»åŠ å¼€å¤´å’Œç»“å°¾è§†é¢‘ï¼ˆå¦‚æœéœ€è¦ï¼‰                           â”‚
â”‚     - è¾“å…¥: è„šæœ¬ä¸­çš„å¼€å¤´/ç»“å°¾ä¿¡æ¯ã€éŸ³é¢‘æ—¶é•¿                  â”‚
â”‚     - è¾“å‡º: opening.mp4, ending.mp4                         â”‚
â”‚     - æ£€æŸ¥: scenes ä¸­æ˜¯å¦å·²æœ‰ id=0 å’Œ id=999 çš„åœºæ™¯         â”‚
â”‚     - é€»è¾‘: å¦‚æœ scenes ä¸­æ²¡æœ‰ï¼Œåˆ™å•ç‹¬ç”Ÿæˆ                   â”‚
â”‚     - å·¥å…·: OpeningEndingGenerator                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. åˆå¹¶åˆ†æ®µéŸ³é¢‘ä¸ºå®Œæ•´éŸ³é¢‘                                   â”‚
â”‚     - è¾“å…¥: åˆ†æ®µéŸ³é¢‘æ–‡ä»¶åˆ—è¡¨                                 â”‚
â”‚     - è¾“å‡º: audio.wavï¼ˆå®Œæ•´éŸ³é¢‘ï¼Œç”¨äºåˆæˆå’Œå­—å¹•ï¼‰            â”‚
â”‚     - æ£€æŸ¥: åˆå¹¶åæ—¶é•¿ä¸åˆ†æ®µæ€»å’Œä¸€è‡´ï¼ˆè¯¯å·® < 0.05sï¼‰         â”‚
â”‚     - å·¥å…·: FFmpeg (concat)                                 â”‚
â”‚     - æ ¼å¼: 48000 Hz ç«‹ä½“å£°                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  8. ç”Ÿæˆå­—å¹•ï¼ˆåŸºäºç²¾ç¡®éŸ³é¢‘æ—¶é•¿åˆ—è¡¨ï¼‰                         â”‚
â”‚     - è¾“å…¥: å®Œæ•´éŸ³é¢‘ + åˆ†æ®µæ–‡æœ¬ + ç²¾ç¡®éŸ³é¢‘æ—¶é•¿åˆ—è¡¨          â”‚
â”‚     - è¾“å‡º: subtitle.srt                                     â”‚
â”‚     - æ£€æŸ¥: æ—¶é—´è½´ä¸¥æ ¼å¯¹åº”éŸ³é¢‘ç‰‡æ®µï¼Œå†…å®¹æ­£ç¡®                 â”‚
â”‚     - æ¨¡å‹:                                                 â”‚
â”‚       â€¢ WhisperX (åŸºäº Faster-Whisper)                     â”‚
â”‚       â€¢ Whisper Small (è¯­éŸ³è¯†åˆ«)                            â”‚
â”‚     - ç‰¹ç‚¹: ä½¿ç”¨ç²¾ç¡®éŸ³é¢‘æ—¶é•¿åˆ—è¡¨ï¼Œç¡®ä¿å­—å¹•ä¸è§†é¢‘å®Œå…¨åŒæ­¥    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  9. æ£€æŸ¥å¹¶å»¶é•¿è§†é¢‘ï¼ˆå¦‚æœéœ€è¦ï¼‰                               â”‚
â”‚     - è¾“å…¥: è§†é¢‘ç‰‡æ®µåˆ—è¡¨ + éŸ³é¢‘æ€»æ—¶é•¿                        â”‚
â”‚     - è¾“å‡º: å»¶é•¿åçš„ç»“å°¾è§†é¢‘ï¼ˆå¦‚æœéœ€è¦ï¼‰                     â”‚
â”‚     - æ£€æŸ¥: è§†é¢‘æ€»æ—¶é•¿ vs éŸ³é¢‘æ€»æ—¶é•¿                         â”‚
â”‚     - é€»è¾‘: å¦‚æœè§†é¢‘ < éŸ³é¢‘ï¼Œå»¶é•¿æœ€åä¸€ä¸ªè§†é¢‘ç‰‡æ®µ            â”‚
â”‚     - å·¥å…·: FFmpeg (é‡å¤æœ€åä¸€å¸§)                           â”‚
â”‚     - æ³¨æ„: å»¶é•¿åéœ€é‡æ–°ç”Ÿæˆå­—å¹•ä»¥ç¡®ä¿åŒæ­¥                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  10. åˆæˆæœ€ç»ˆè§†é¢‘ âš ï¸ å…³é”®æ­¥éª¤                                â”‚
â”‚     - è¾“å…¥: è§†é¢‘ç‰‡æ®µ + å®Œæ•´éŸ³é¢‘ + subtitle.srt + BGM        â”‚
â”‚     - è¾“å‡º: output.mp4                                       â”‚
â”‚     - æ£€æŸ¥: éŸ³é¢‘æ··åˆã€BGMã€å­—å¹•åŒæ­¥ã€æ—¶é•¿åŒ¹é…                â”‚
â”‚     - å·¥å…·:                                                 â”‚
â”‚       â€¢ FFmpeg (è§†é¢‘åˆæˆã€éŸ³é¢‘æ··åˆã€å­—å¹•ç¡¬ç¼–ç )              â”‚
â”‚     - ç‰¹ç‚¹: è§†é¢‘ç‰‡æ®µå·²ç²¾ç¡®åŒ¹é…éŸ³é¢‘ï¼Œç›´æ¥åˆæˆå³å¯            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  11. åå¤„ç†ï¼ˆå¯é€‰ï¼‰                                          â”‚
â”‚     - è¾“å…¥: output.mp4                                       â”‚
â”‚     - è¾“å‡º: output_upx2.mp4                                 â”‚
â”‚     - æ¨¡å‹:                                                 â”‚
â”‚       â€¢ Real-ESRGAN x4plus (è§†é¢‘è¶…åˆ†è¾¨ç‡)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ æµç¨‹ä¼˜åŒ–è¯´æ˜

**å…³é”®æ”¹è¿›ç‚¹ï¼š**

1. **åˆ†æ®µéŸ³é¢‘ç”Ÿæˆ**ï¼šæ¯ä¸ªåœºæ™¯ç”Ÿæˆç‹¬ç«‹çš„éŸ³é¢‘æ–‡ä»¶ï¼Œå¯ä»¥ï¼š
   - ç²¾ç¡®è·å–æ¯ä¸ªç‰‡æ®µçš„å®é™…éŸ³é¢‘æ—¶é•¿ï¼ˆTTSç”Ÿæˆï¼Œ100%å‡†ç¡®ï¼‰
   - æ”¯æŒç¼“å­˜å¤ç”¨ï¼Œé¿å…é‡å¤ç”Ÿæˆ
   - å®¹é”™æ€§å¥½ï¼Œå•ä¸ªç‰‡æ®µå¤±è´¥ä¸å½±å“å…¶ä»–

2. **ç²¾ç¡®æ—¶é•¿åŒ¹é…**ï¼š
   - è§†é¢‘ç”Ÿæˆä½¿ç”¨ç²¾ç¡®çš„éŸ³é¢‘æ—¶é•¿ï¼Œé€šè¿‡ `num_frames = round(duration * fps)` è®¡ç®—ç²¾ç¡®å¸§æ•°
   - è§†é¢‘ä¸éŸ³é¢‘å®Œå…¨åŒæ­¥ï¼Œè¯¯å·® < 0.05ç§’

3. **å¼€å¤´å’Œç»“å°¾å¤„ç†**ï¼š
   - æ”¯æŒåœ¨ scenes ä¸­å®šä¹‰å¼€å¤´åœºæ™¯ï¼ˆid=0ï¼‰å’Œç»“å°¾åœºæ™¯ï¼ˆid=999ï¼‰
   - å¦‚æœæ²¡æœ‰ï¼Œåˆ™å•ç‹¬ç”Ÿæˆå¼€å¤´å’Œç»“å°¾è§†é¢‘

4. **éŸ³é¢‘åˆå¹¶**ï¼š
   - åˆ†æ®µéŸ³é¢‘åˆå¹¶ä¸ºå®Œæ•´éŸ³é¢‘ï¼Œç”¨äºå­—å¹•ç”Ÿæˆå’Œæœ€ç»ˆåˆæˆ
   - ç¡®ä¿åˆå¹¶åæ—¶é•¿ä¸åˆ†æ®µæ€»å’Œä¸€è‡´

5. **å­—å¹•åŒæ­¥**ï¼š
   - ä½¿ç”¨ç²¾ç¡®éŸ³é¢‘æ—¶é•¿åˆ—è¡¨ç”Ÿæˆå­—å¹•ï¼Œç¡®ä¿æ—¶é—´è½´ä¸¥æ ¼å¯¹åº”
   - å¦‚æœè§†é¢‘å»¶é•¿ï¼Œä¼šé‡æ–°ç”Ÿæˆå­—å¹•ä»¥ç¡®ä¿åŒæ­¥

## ğŸ¤– ä½¿ç”¨çš„æ¨¡å‹è¯¦ç»†åˆ—è¡¨

### 1. å›¾åƒç”Ÿæˆæ¨¡å‹

#### 1.1 Stable Diffusion XL (SDXL)
- **ç”¨é€”**: åŸºç¡€å›¾åƒç”Ÿæˆæ¨¡å‹
- **æ¨¡å‹è·¯å¾„**: `/vepfs-dev/shawn/vid/fanren/gen_video/models/sdxl-base`
- **æ¥æº**: HuggingFace `stabilityai/stable-diffusion-xl-base-1.0`
- **æ¡†æ¶**: Diffusers
- **ç²¾åº¦**: FP16 (æ··åˆç²¾åº¦)
- **åˆ†è¾¨ç‡**: 1280x720
- **æ¨ç†æ­¥æ•°**: 55
- **å¼•å¯¼å°ºåº¦**: 8.5
- **ç‰¹ç‚¹**: 
  - æ”¯æŒé«˜åˆ†è¾¨ç‡å›¾åƒç”Ÿæˆ
  - ä½¿ç”¨ VAE Tiling ä¼˜åŒ–æ˜¾å­˜
  - æ”¯æŒ CPU Offload

#### 1.2 LoRA (Low-Rank Adaptation)
- **ç”¨é€”**: è§’è‰²å®šåˆ¶ï¼ˆéŸ©ç«‹ï¼‰
- **æ¨¡å‹è·¯å¾„**: `/vepfs-dev/shawn/vid/fanren/gen_video/models/lora/hanli/pytorch_lora_weights.safetensors`
- **é€‚é…å™¨åç§°**: `hanli`
- **æƒé‡ (alpha)**: 1.0
- **ä½¿ç”¨ç­–ç•¥**: 
  - ä»…åœ¨éœ€è¦ä¸»è§’çš„åœºæ™¯ä½¿ç”¨
  - çº¯èƒŒæ™¯åœºæ™¯ä¸ä½¿ç”¨ LoRAï¼ˆæƒé‡è®¾ä¸º 0.0ï¼‰
- **è®­ç»ƒæ–¹å¼**: DreamBooth LoRA
- **ç‰¹ç‚¹**: 
  - è½»é‡çº§ï¼Œä¸å½±å“åŸºç¡€æ¨¡å‹
  - å¯åŠ¨æ€æ§åˆ¶æƒé‡

#### 1.3 IP-Adapter (Image Prompt Adapter)
- **ç”¨é€”**: å›¾åƒå‚è€ƒé€‚é…ï¼Œä¿æŒè§’è‰²ä¸€è‡´æ€§
- **æ¨¡å‹è·¯å¾„**: `/vepfs-dev/shawn/vid/fanren/gen_video/models/ip-adapter/sdxl_models/ip-adapter_sdxl.bin`
- **æƒé‡ (scale)**: 0.7
- **å‚è€ƒå›¾åƒå°ºå¯¸**: 224x224 (CLIP), 160x160 (é¢éƒ¨)
- **é¢éƒ¨è£å‰ªæ¯”ä¾‹**: 0.75
- **ä½¿ç”¨ç­–ç•¥**: 
  - ä»…ä½¿ç”¨é¢éƒ¨å‚è€ƒ (`face_reference_only: true`)
  - ä¸ LoRA é…åˆä½¿ç”¨ï¼Œé™ä½æƒé‡é¿å…è¿‡åº¦å½±å“
- **ç‰¹ç‚¹**: 
  - æ”¯æŒå›¾åƒåˆ°å›¾åƒçš„é£æ ¼è¿ç§»
  - å¯æ§åˆ¶å‚è€ƒå¼ºåº¦

### 2. è§†é¢‘ç”Ÿæˆæ¨¡å‹

#### 2.1 Stable Video Diffusion XT (SVD-XT)
- **ç”¨é€”**: å›¾åƒè½¬è§†é¢‘
- **æ¨¡å‹è·¯å¾„**: `/vepfs-dev/shawn/vid/fanren/gen_video/models/svd`
- **æ¥æº**: HuggingFace `stabilityai/stable-video-diffusion-img2vid-xt`
- **æ¡†æ¶**: Diffusers (`StableVideoDiffusionPipeline`)
- **ç²¾åº¦**: FP16
- **ç”Ÿæˆå‚æ•°**:
  - å¸§æ•°: 20
  - å¸§ç‡: 12 fps
  - åˆ†è¾¨ç‡: 1280x720
  - æ¨ç†æ­¥æ•°: 70
  - å¼•å¯¼å°ºåº¦: 7.5
  - Motion Bucket ID: 64
  - å™ªå£°å¢å¼ºå¼ºåº¦: 0.01
- **è§†é¢‘æ—¶é•¿**: çº¦ 5 ç§’ (20å¸§ / 12fps)
- **ç‰¹ç‚¹**: 
  - åŸºäºå›¾åƒæ¡ä»¶ç”ŸæˆçŸ­è§†é¢‘
  - æ”¯æŒè¿åŠ¨æ§åˆ¶
  - ä½¿ç”¨ VAE Slicing/Tiling ä¼˜åŒ–æ˜¾å­˜

### 3. æ–‡æœ¬è½¬è¯­éŸ³ (TTS) æ¨¡å‹

#### 3.1 ChatTTS
- **ç”¨é€”**: ç”Ÿæˆé…éŸ³ï¼ˆå¥³å£°æ—ç™½ï¼‰
- **å¼•æ“**: `chattts`
- **ç‰ˆæœ¬**: æœ€æ–°ç‰ˆæœ¬ï¼ˆé€šè¿‡ `pip install ChatTTS` å®‰è£…ï¼‰
- **é‡‡æ ·ç‡**: 24000 Hz
- **å£°é“**: å•å£°é“
- **å‚æ•°**:
  - Temperature: 0.3 (æ§åˆ¶éšæœºæ€§)
  - Speed: 1.0 (è¯­é€Ÿ)
  - Pitch: 1.0 (éŸ³è°ƒ)
  - Oral Ability: 1 (å£è¯­åŒ–ç¨‹åº¦)
  - Seed: 777 (éšæœºç§å­)
- **é£æ ¼æ§åˆ¶**:
  - Style Prompt: "å¥³æ€§å£°éŸ³ï¼Œæ¸©æŸ”çŸ¥æ€§ï¼Œæƒ…ç»ªå¹³ç¨³ï¼Œè¯­è°ƒäº²åˆ‡è‡ªç„¶ï¼Œè§£è¯´è¯­æ°”ï¼Œåå­—æ¸…æ™°ï¼Œè¯­é€Ÿé€‚ä¸­ï¼Œå¥æœ«è½»æŸ”æ”¶å°¾ï¼Œå¥³å£°æ—ç™½"
  - Negative Prompt: "ç”·æ€§å£°éŸ³ï¼Œç”·å£°ï¼Œè¿‡åº¦å¤¸å¼ ã€æœºæ¢°æ„Ÿã€è¯­é€Ÿè¿‡å¿«ã€å’¬å­—å«ç³Š"
- **ç‰¹ç‚¹**: 
  - æ”¯æŒä¸­æ–‡è¯­éŸ³åˆæˆ
  - å¯æ§åˆ¶è¯­éŸ³é£æ ¼å’Œæƒ…æ„Ÿ
  - æ”¯æŒé•¿æ–‡æœ¬ç”Ÿæˆ

### 4. è¯­éŸ³è¯†åˆ«æ¨¡å‹

#### 4.1 WhisperX (åŸºäº Faster-Whisper)
- **ç”¨é€”**: è¯­éŸ³è¯†åˆ«å’Œå­—å¹•ç”Ÿæˆ
- **åŸºç¡€æ¨¡å‹**: Whisper Small
- **æ¨¡å‹è·¯å¾„**: `models/faster-whisper-small`
- **æ¥æº**: HuggingFace `openai/whisper-small`
- **æ¡†æ¶**: Faster-Whisper (CTranslate2 åç«¯)
- **è¯­è¨€**: ä¸­æ–‡ (zh)
- **è®¡ç®—ç±»å‹**: 
  - CUDA: float16
  - CPU: int8
- **å¯¹é½åŠŸèƒ½**: å·²ç¦ç”¨ï¼ˆé¿å…æ®µé”™è¯¯ï¼‰
- **VAD (Voice Activity Detection)**: å·²ç¦ç”¨ï¼ˆé¿å…æ®µé”™è¯¯ï¼‰
- **ç‰¹ç‚¹**: 
  - å¿«é€Ÿæ¨ç†ï¼ˆFaster-Whisper ä¼˜åŒ–ï¼‰
  - æ”¯æŒæ—¶é—´å¯¹é½ï¼ˆå½“å‰ç¦ç”¨ï¼‰
  - æ”¯æŒå¤šç§å­—å¹•æ ¼å¼ (SRT, VTT, ASS)

### 5. è§†é¢‘è¶…åˆ†è¾¨ç‡æ¨¡å‹

#### 5.1 Real-ESRGAN x4plus
- **ç”¨é€”**: è§†é¢‘åå¤„ç†ï¼Œæå‡åˆ†è¾¨ç‡
- **æ¨¡å‹è·¯å¾„**: `models/realesrgan/RealESRGAN_x4plus.pth`
- **æ¥æº**: [Real-ESRGAN GitHub](https://github.com/xinntao/Real-ESRGAN)
- **æ¨¡å‹ç±»å‹**: RealESRGAN_x4plus
- **æ”¾å¤§å€æ•°**: 4x (æ¨¡å‹) â†’ 2x (è¾“å‡ºï¼Œoutscale=2.0)
- **ç²¾åº¦**: FP16 (full_precision=false)
- **Tile å¤§å°**: 0 (è‡ªåŠ¨)
- **ç‰¹ç‚¹**: 
  - é€šç”¨åœºæ™¯è¶…åˆ†è¾¨ç‡
  - æ”¯æŒè§†é¢‘æ‰¹é‡å¤„ç†
  - ä¿ç•™éŸ³é¢‘è½¨é“

### 6. è§†é¢‘å¤„ç†å·¥å…·

#### 6.1 FFmpeg
- **ç”¨é€”**: è§†é¢‘åˆæˆã€éŸ³é¢‘æ··åˆã€å­—å¹•ç¡¬ç¼–ç 
- **ç‰ˆæœ¬**: ç³»ç»Ÿå®‰è£…ç‰ˆæœ¬
- **åŠŸèƒ½**:
  - è§†é¢‘æ‹¼æ¥ (`concat` æ»¤é•œ)
  - éŸ³é¢‘æ··åˆ (`amix` æ»¤é•œ)
  - å­—å¹•ç¡¬ç¼–ç  (`subtitles` æ»¤é•œ)
  - é‡‡æ ·ç‡è½¬æ¢ (`aresample`)
  - å£°é“è½¬æ¢ (`aformat`)
  - è§†é¢‘ç¼©æ”¾ (`scale`)
  - é”åŒ– (`unsharp`)
- **ç¼–ç å™¨**:
  - è§†é¢‘: libx264 (H.264)
  - éŸ³é¢‘: aac
- **å‚æ•°**:
  - è§†é¢‘æ¯”ç‰¹ç‡: 8000k
  - éŸ³é¢‘æ¯”ç‰¹ç‡: 192k
  - è¾“å‡ºåˆ†è¾¨ç‡: 1280x720

## ğŸ“¦ æ¨¡å‹æ¥æºå’Œä¸‹è½½

### HuggingFace æ¨¡å‹
1. **SDXL Base**: `stabilityai/stable-diffusion-xl-base-1.0`
2. **SVD-XT**: `stabilityai/stable-video-diffusion-img2vid-xt`
3. **Whisper Small**: `openai/whisper-small`

### è‡ªå®šä¹‰è®­ç»ƒæ¨¡å‹
1. **LoRA (hanli)**: ä½¿ç”¨ DreamBooth LoRA è®­ç»ƒï¼ŒåŸºäº SDXL
   - è®­ç»ƒè„šæœ¬: `train_lora.sh`
   - è®­ç»ƒæ•°æ®: ä¸»è§’ï¼ˆéŸ©ç«‹ï¼‰å›¾åƒ

### ç¬¬ä¸‰æ–¹æ¨¡å‹
1. **IP-Adapter**: HuggingFace `h94/IP-Adapter`
2. **Real-ESRGAN**: GitHub `xinntao/Real-ESRGAN`

### Python åŒ…æ¨¡å‹
1. **ChatTTS**: é€šè¿‡ `pip install ChatTTS` å®‰è£…ï¼Œæ¨¡å‹è‡ªåŠ¨ä¸‹è½½

## ğŸ”§ æ¨¡å‹é…ç½®å‚æ•°

### å›¾åƒç”Ÿæˆå‚æ•°
```yaml
num_inference_steps: 55        # æ¨ç†æ­¥æ•°
guidance_scale: 8.5            # å¼•å¯¼å°ºåº¦
lora_alpha: 1.0               # LoRA æƒé‡
ip_adapter_scale: 0.7         # IP-Adapter æƒé‡
```

### è§†é¢‘ç”Ÿæˆå‚æ•°
```yaml
num_frames: 20                # ç”Ÿæˆå¸§æ•°
fps: 12                        # å¸§ç‡
num_inference_steps: 70        # æ¨ç†æ­¥æ•°
guidance_scale: 7.5            # å¼•å¯¼å°ºåº¦
motion_bucket_id: 64           # è¿åŠ¨æ¡¶ID
noise_aug_strength: 0.01       # å™ªå£°å¢å¼ºå¼ºåº¦
```

### TTS å‚æ•°
```yaml
temperature: 0.3               # éšæœºæ€§
speed: 1.0                     # è¯­é€Ÿ
pitch: 1.0                     # éŸ³è°ƒ
oral_ability: 1                # å£è¯­åŒ–ç¨‹åº¦
seed: 777                      # éšæœºç§å­
```

### å­—å¹•è¯†åˆ«å‚æ•°
```yaml
model_size: small             # Whisper æ¨¡å‹å¤§å°
language: zh                   # è¯­è¨€ä»£ç 
align: false                   # æ˜¯å¦å¯ç”¨å¯¹é½
use_script_segments: false     # æ˜¯å¦ä½¿ç”¨è„šæœ¬åˆ†æ®µ
```

## ğŸ’¡ æ¨¡å‹é€‰æ‹©ç†ç”±

### å›¾åƒç”Ÿæˆ
- **SDXL**: å½“å‰æœ€å¼ºçš„å¼€æºå›¾åƒç”Ÿæˆæ¨¡å‹ï¼Œæ”¯æŒé«˜åˆ†è¾¨ç‡ï¼Œè´¨é‡ä¼˜ç§€
- **LoRA**: è½»é‡çº§è§’è‰²å®šåˆ¶æ–¹æ¡ˆï¼Œè®­ç»ƒæˆæœ¬ä½ï¼Œä¸å½±å“åŸºç¡€æ¨¡å‹
- **IP-Adapter**: å›¾åƒå‚è€ƒé€‚é…ï¼Œä¿æŒè§’è‰²ä¸€è‡´æ€§ï¼Œæƒé‡å¯è°ƒ

### è§†é¢‘ç”Ÿæˆ
- **SVD-XT**: Stability AI æœ€æ–°çš„å›¾åƒè½¬è§†é¢‘æ¨¡å‹ï¼Œè´¨é‡ä¼˜ç§€ï¼Œæ”¯æŒé•¿è§†é¢‘ï¼ˆ25å¸§ï¼‰

### TTS
- **ChatTTS**: æ”¯æŒä¸­æ–‡ï¼Œå¯æ§åˆ¶è¯­éŸ³é£æ ¼ï¼Œé€‚åˆæ—ç™½åœºæ™¯

### è¯­éŸ³è¯†åˆ«
- **Whisper Small**: å¹³è¡¡é€Ÿåº¦å’Œå‡†ç¡®ç‡ï¼Œé€‚åˆä¸­æ–‡è¯†åˆ«

### è¶…åˆ†è¾¨ç‡
- **Real-ESRGAN x4plus**: é€šç”¨åœºæ™¯è¶…åˆ†è¾¨ç‡ï¼Œæ•ˆæœç¨³å®š

## ğŸ” å…³é”®æ£€æŸ¥ç‚¹

### TTS ç”Ÿæˆï¼ˆæ­¥éª¤ 4ï¼‰
- âœ… å¼•æ“å¿…é¡»æ˜¯ `chattts`ï¼ˆä¸æ˜¯ `piper`ï¼‰
- âœ… Style prompt å¿…é¡»åŒ…å«"å¥³æ€§å£°éŸ³"
- âœ… è¯­é€Ÿ `speed` åº”è¯¥ä¸º 1.0
- âœ… ç”Ÿæˆçš„éŸ³é¢‘åº”è¯¥æ˜¯ 24000 Hz å•å£°é“
- âœ… æ’­æ”¾éŸ³é¢‘ç¡®è®¤æ˜¯å¥³å£°ã€è¯­é€Ÿæ­£å¸¸ã€å†…å®¹æ­£ç¡®

### è§†é¢‘åˆæˆï¼ˆæ­¥éª¤ 6ï¼‰
- âœ… `audio_path` å¿…é¡»æ­£ç¡®ä¼ é€’
- âœ… BGM æ–‡ä»¶å¿…é¡»å­˜åœ¨
- âœ… `bgm.enabled` å¿…é¡»ä¸º `true`
- âœ… éŸ³é¢‘æ··åˆé€»è¾‘æ­£ç¡®ï¼ˆé…éŸ³ + BGMï¼‰
- âœ… æœ€ç»ˆè§†é¢‘ä¸­çš„éŸ³é¢‘æµåº”è¯¥æ˜¯ 48000 Hz ç«‹ä½“å£°

## ğŸ“ å½“å‰é—®é¢˜åˆ†æ

æ ¹æ®è¯Šæ–­ç»“æœï¼Œé…ç½®å’Œæ–‡ä»¶æ ¼å¼éƒ½æ˜¯æ­£ç¡®çš„ï¼Œä½†æ‚¨åé¦ˆçš„é—®é¢˜æ˜¯ï¼š
- âŒ ç”·å£°ï¼ˆåº”è¯¥æ˜¯å¥³å£°ï¼‰
- âŒ è¯­é€Ÿå¿«
- âŒ å†…å®¹ä¸å¯¹
- âŒ æ²¡æœ‰èƒŒæ™¯éŸ³ä¹

**æœ€å¯èƒ½çš„åŸå› **ï¼š
1. **éŸ³é¢‘æ–‡ä»¶å†…å®¹é”™è¯¯**ï¼šè™½ç„¶æ ¼å¼æ­£ç¡®ï¼Œä½†å†…å®¹å¯èƒ½æ˜¯ä¹‹å‰ç”Ÿæˆçš„é”™è¯¯éŸ³é¢‘
2. **è§†é¢‘åˆæˆæ—¶ä½¿ç”¨äº†é”™è¯¯çš„éŸ³é¢‘**ï¼šåˆæˆæ—¶ `audio_path` æŒ‡å‘äº†é”™è¯¯çš„æ–‡ä»¶

**å»ºè®®çš„è§£å†³æ­¥éª¤**ï¼š
1. åˆ é™¤æ—§éŸ³é¢‘æ–‡ä»¶
2. é‡æ–°ç”ŸæˆéŸ³é¢‘ï¼ˆä½¿ç”¨ ChatTTSï¼‰
3. æ’­æ”¾æ–°éŸ³é¢‘ç¡®è®¤æ­£ç¡®
4. é‡æ–°ç”Ÿæˆå­—å¹•
5. é‡æ–°åˆæˆè§†é¢‘

## ğŸ› ï¸ è°ƒè¯•å·¥å…·

### æ£€æŸ¥éŸ³é¢‘å†…å®¹
```bash
# ä½¿ç”¨ Python æ£€æŸ¥éŸ³é¢‘ç‰¹å¾
python - <<'PY'
import soundfile as sf
import numpy as np

data, sr = sf.read('outputs/lingjie_ep5_auto_v2/audio.wav')
print(f"é‡‡æ ·ç‡: {sr} Hz")
print(f"æ—¶é•¿: {len(data)/sr:.2f} ç§’")
print(f"éŸ³é¢‘èƒ½é‡: {np.mean(np.abs(data)):.3f}")
PY
```

### æå–è§†é¢‘ä¸­çš„éŸ³é¢‘
```bash
# æå–è§†é¢‘ä¸­çš„éŸ³é¢‘ï¼Œå•ç‹¬æ£€æŸ¥
ffmpeg -i outputs/lingjie_ep5_auto_v2/lingjie_ep5_auto_v2.mp4 \
       -vn -acodec copy \
       extracted_audio.aac
```

### æµ‹è¯• TTS ç”Ÿæˆ
```bash
# å•ç‹¬æµ‹è¯• TTS ç”Ÿæˆ
python - <<'PY'
from tts_generator import TTSGenerator

tts = TTSGenerator('config.yaml')
test_text = "ä»™å‹ä»¬å¥½ï¼Œæˆ‘æ˜¯äº‘å·ä»™éŸ³ã€‚"
tts.generate(test_text, "test_output.wav")
print("âœ“ æµ‹è¯•éŸ³é¢‘å·²ç”Ÿæˆ: test_output.wav")
PY
```

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `config.yaml` - ä¸»é…ç½®æ–‡ä»¶
- `run_pipeline.py` - ä¸»æµæ°´çº¿è„šæœ¬
- `tts_generator.py` - TTS ç”Ÿæˆå™¨
- `subtitle_generator.py` - å­—å¹•ç”Ÿæˆå™¨
- `video_composer.py` - è§†é¢‘åˆæˆå™¨
- `main.py` - æµæ°´çº¿ä¸»ç±»

## ğŸ’¡ ä¸‹ä¸€æ­¥

1. **è¿è¡Œè¯Šæ–­è„šæœ¬**ï¼š`python diagnose.py lingjie_ep5_auto_v2`
2. **æŸ¥çœ‹è¯Šæ–­ç»“æœ**ï¼šç¡®è®¤é…ç½®å’Œæ–‡ä»¶çŠ¶æ€
3. **é‡æ–°ç”ŸæˆéŸ³é¢‘**ï¼šä½¿ç”¨ `regenerate_audio.sh` æˆ–æ‰‹åŠ¨æ‰§è¡Œ
4. **æ’­æ”¾æ£€æŸ¥**ï¼šç¡®è®¤éŸ³é¢‘æ˜¯å¥³å£°ã€è¯­é€Ÿæ­£å¸¸ã€å†…å®¹æ­£ç¡®
5. **å¦‚æœä»æœ‰é—®é¢˜**ï¼šæŸ¥çœ‹ `é—®é¢˜æ’æŸ¥æŒ‡å—.md` çš„è¯¦ç»†æ­¥éª¤

---

**æç¤º**ï¼šå¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æä¾›ï¼š
1. è¯Šæ–­è„šæœ¬çš„å®Œæ•´è¾“å‡º
2. é‡æ–°ç”ŸæˆéŸ³é¢‘æ—¶çš„æ—¥å¿—
3. è§†é¢‘åˆæˆæ—¶çš„æ—¥å¿—ï¼ˆå¦‚æœæœ‰ï¼‰

è¿™æ ·æˆ‘å¯ä»¥æ›´å‡†ç¡®åœ°å®šä½é—®é¢˜ã€‚

