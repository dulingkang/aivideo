# CosyVoice 声音质量问题（wuluwulu）排查

## 问题描述

即使使用官方代码，生成的声音仍然是"wuluwulu"听不清。

## 测试结果

### 测试 1: text_frontend=False
- 时长: 30.60 秒（异常长）
- 文件大小: 1434.45 KB
- 数值范围: [-0.6964, 0.7210]
- 平均能量: 0.005729

### 测试 2: text_frontend=True
- 时长: 11.80 秒（更合理）
- 文件大小: 553.20 KB
- 数值范围: [-0.5027, 0.4583]
- 平均能量: 0.004874

### 测试 3: 短文本
- 时长: 9.60 秒
- 文本: "大家好，我是科普主持人。"

## 关键发现

1. **使用 wetext 而不是 ttsfrd**
   - Python 3.12 无法使用 cp310 的 ttsfrd wheel
   - 自动回退到 wetext
   - 可能影响文本处理和音频质量

2. **音频文件本身看起来正常**
   - 数值范围合理
   - 能量正常
   - 但声音听不清

3. **text_frontend 参数的影响**
   - `text_frontend=False`: 生成了更长的音频（30.60 秒）
   - `text_frontend=True`: 生成了更合理的音频（11.80 秒）

## 可能的原因

1. **wetext 和 ttsfrd 的文本处理差异**
   - wetext 可能没有正确处理某些文本
   - 导致生成的 token 序列不正确

2. **模型权重问题**
   - 可能需要重新下载模型权重
   - 或者检查权重文件是否完整

3. **环境配置问题**
   - 依赖版本不匹配
   - Python 3.12 的兼容性问题

## 建议的解决方案

### 方案 1: 使用 Python 3.10 环境（推荐）
- 创建 Python 3.10 的虚拟环境
- 安装 ttsfrd（cp310 wheel）
- 使用 ttsfrd 进行文本处理

### 方案 2: 检查 wetext 的文本处理
- 验证 wetext 是否正确处理中文文本
- 检查是否有文本处理错误

### 方案 3: 重新下载模型权重
- 确保模型权重文件完整
- 检查权重文件是否损坏

## 相关文件

- 测试文件: `CosyVoice/test.py`
- 生成的音频: `CosyVoice/zero_shot_*.wav`
- 前端代码: `CosyVoice/cosyvoice/cli/frontend.py`

