# ä¾èµ–æ£€æŸ¥æ€»ç»“

## âœ… æ£€æŸ¥ç»“æœ

**æ‰€æœ‰æ¨¡å‹å’Œæ¨¡å—éƒ½å·²å°±ç»ªï¼**

## ğŸ“‹ å·²å°±ç»ªçš„ç»„ä»¶

### 1. å›¾åƒç”Ÿæˆæ¨¡å‹
- âœ… SDXL åŸºç¡€æ¨¡å‹ï¼ˆå®Œæ•´ï¼‰
- âœ… InstantID ControlNetï¼ˆå®Œæ•´ï¼‰
- âœ… InstantID IP-Adapterï¼ˆ1612.8 MBï¼‰
- âœ… é¢éƒ¨å‚è€ƒå›¾åƒï¼ˆéŸ©ç«‹_mid.pngï¼‰
- âœ… LoRA æƒé‡ï¼ˆ708.9 MBï¼‰

### 2. è§†é¢‘ç”Ÿæˆæ¨¡å‹
- âœ… SVD æ¨¡å‹ï¼ˆå®Œæ•´ï¼‰

### 3. TTS æ¨¡å‹
- âœ… CosyVoice2-0.5Bï¼ˆå®Œæ•´ï¼‰
- âœ… CosyVoice å‚è€ƒéŸ³é¢‘ï¼ˆzero_shot_prompt.wavï¼‰

### 4. å­—å¹•æ¨¡å‹
- âœ… Whisper mediumï¼ˆå®Œæ•´ï¼‰

### 5. åå¤„ç†æ¨¡å‹
- âœ… Real-ESRGANï¼ˆRealESRGAN_x4plus_anime_6B.pthï¼‰

### 6. èµ„æºæ–‡ä»¶
- âœ… èƒŒæ™¯éŸ³ä¹ï¼ˆ4 ä¸ªéŸ³è½¨éƒ½å·²å°±ç»ªï¼‰

### 7. Python æ¨¡å—
- âœ… InstantIDï¼ˆé€šè¿‡è·¯å¾„å¯¼å…¥ï¼Œå¯ç”¨ï¼‰
- âœ… CosyVoiceï¼ˆé€šè¿‡è·¯å¾„å¯¼å…¥ï¼Œå¯ç”¨ï¼‰
- âœ… torch, diffusers, transformers
- âœ… PIL, cv2, numpy, yaml
- âœ… insightface
- âœ… imageio, ffmpeg-python
- âœ… omegaconf

### 8. ç³»ç»Ÿå·¥å…·
- âœ… ffmpegï¼ˆå·²å®‰è£…ï¼Œç‰ˆæœ¬ 6.1.1ï¼‰

### 9. é¡¹ç›®æ¨¡å—
- âœ… image_generator
- âœ… video_generator
- âœ… tts_generator
- âœ… subtitle_generator
- âœ… video_composer
- âœ… main

## âš ï¸ å¯é€‰ç»„ä»¶

### generative-models
- âš ï¸ éƒ¨åˆ†åŠŸèƒ½ä¸å¯ç”¨ï¼ˆç¼ºå°‘ `imwatermark` æ¨¡å—ï¼‰
- âœ… ä¸å½±å“ä½¿ç”¨ï¼Œä»£ç ä¼šè‡ªåŠ¨ä½¿ç”¨ diffusers ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆ

## ğŸ“ é‡è¦è¯´æ˜

### InstantID å’Œ CosyVoice çš„å®‰è£…æ–¹å¼

è¿™ä¸¤ä¸ªæ¨¡å—**ä¸æ˜¯é€šè¿‡ pip å®‰è£…çš„**ï¼Œè€Œæ˜¯é€šè¿‡è·¯å¾„å¯¼å…¥ï¼š

1. **InstantID**ï¼š
   - ä½ç½®ï¼š`/vepfs-dev/shawn/vid/fanren/InstantID`
   - å¯¼å…¥æ–¹å¼ï¼šä»£ç ä¼šè‡ªåŠ¨å°†ç›®å½•æ·»åŠ åˆ° `sys.path`ï¼Œç„¶åå¯¼å…¥ `pipeline_stable_diffusion_xl_instantid`
   - âœ… å·²å°±ç»ª

2. **CosyVoice**ï¼š
   - ä½ç½®ï¼š`/vepfs-dev/shawn/vid/fanren/CosyVoice`
   - å¯¼å…¥æ–¹å¼ï¼šä»£ç ä¼šè‡ªåŠ¨å°†ç›®å½•æ·»åŠ åˆ° `sys.path`ï¼Œç„¶åå¯¼å…¥ `cosyvoice.cli.cosyvoice`
   - âœ… å·²å°±ç»ª

### ä¸ºä»€ä¹ˆ test_stage1.py èƒ½é€šè¿‡ï¼Ÿ

`test_stage1.py` èƒ½é€šè¿‡æ˜¯å› ä¸ºï¼š
1. ä»£ç åœ¨å¯¼å…¥å‰ä¼šè‡ªåŠ¨å°† InstantID å’Œ CosyVoice ç›®å½•æ·»åŠ åˆ° `sys.path`
2. æ‰€æœ‰å¿…éœ€çš„æ¨¡å‹æ–‡ä»¶éƒ½å·²å­˜åœ¨
3. æ‰€æœ‰ Python ä¾èµ–éƒ½å·²å®‰è£…

## ğŸš€ ä¸‹ä¸€æ­¥

ç°åœ¨å¯ä»¥å¼€å§‹è¿è¡Œå®Œæ•´çš„è§†é¢‘ç”Ÿæˆæµç¨‹ï¼š

```bash
cd /vepfs-dev/shawn/vid/fanren/gen_video
source /vepfs-dev/shawn/venv/py312/bin/activate

# è¿è¡Œå®Œæ•´æµç¨‹
python run_pipeline.py \
    --markdown ../lingjie/5-é’ç½—æ²™æ¼ .md \
    --image-dir ../lingjie/img2/jpgsrc \
    --output lingjie_ep5
```

æˆ–è€…åˆ†æ­¥æ‰§è¡Œï¼š

```bash
# 1. åªç”Ÿæˆå›¾åƒ
python run_pipeline.py --skip-video --skip-tts --skip-subtitle --skip-compose ...

# 2. åªç”Ÿæˆè§†é¢‘
python run_pipeline.py --skip-image --skip-tts --skip-subtitle --skip-compose ...

# 3. åªç”Ÿæˆé…éŸ³
python run_pipeline.py --skip-image --skip-video --skip-subtitle --skip-compose ...

# 4. åˆæˆæœ€ç»ˆè§†é¢‘
python run_pipeline.py --skip-image --skip-video --skip-tts ...
```

## ğŸ” æ£€æŸ¥å‘½ä»¤

éšæ—¶å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ä¾èµ–ï¼š

```bash
# æ£€æŸ¥æ¨¡å‹å’Œæ¨¡å—
python check_models_and_modules.py

# æ£€æŸ¥å®Œæ•´æµç¨‹ä¾èµ–
python check_full_pipeline.py
```

