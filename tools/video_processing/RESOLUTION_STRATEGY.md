# 视频分辨率处理策略

## 当前情况

- **4K视频**: 3840x2160 (142, 151, 165集等)
- **1080P视频**: 1920x1080 (170, 171集等)

## 方案对比

### 方案1: 4K直接转成1080P（统一处理）

**优点:**
- ✅ 统一处理流程，参数一致
- ✅ 文件大小更小，处理更快
- ✅ 存储空间节省
- ✅ 后续处理（切分、标注等）速度更快

**缺点:**
- ❌ 损失4K的细节信息
- ❌ 如果后续要超分，从1080P超分效果不如从更高分辨率超分

**适用场景:**
- 最终输出目标是1080P
- 不需要保留4K细节
- 追求处理速度和存储效率

### 方案2: 保持4K，分别处理（推荐）

**优点:**
- ✅ 保留4K的细节信息
- ✅ 如果后续超分，质量更好
- ✅ 未来可以输出4K版本

**缺点:**
- ❌ 需要维护两套参数
- ❌ 文件更大，处理更慢
- ❌ 存储空间占用更多

**适用场景:**
- 需要保留最高质量
- 后续可能超分到更高分辨率
- 有足够的存储和处理时间

### 方案3: 4K缩放到中等分辨率（1600x900），统一超分（最佳平衡）

**优点:**
- ✅ 统一处理流程（都缩放到1600x900）
- ✅ 保留更多细节（比直接到1080P好）
- ✅ 后续统一超分到更高分辨率
- ✅ 平衡质量和处理速度

**缺点:**
- ❌ 需要额外的超分步骤
- ❌ 处理时间更长

**适用场景:**
- 需要高质量输出
- 可以接受额外的超分处理时间
- 追求质量和效率的平衡

## 推荐方案

### 推荐：方案3（统一缩放到1600x900，然后超分）

**理由:**
1. 统一处理流程，参数一致
2. 保留更多细节（1600x900 > 1080P的细节）
3. 后续超分效果更好
4. 可以输出到更高分辨率（如2K或4K）

**处理流程:**

#### 4K视频
```bash
python3 tools/video_processing/pipeline.py \
  --episode 142 \
  --input gen_video/raw_videos/142_4K.mp4 \
  --crop 3840:1960:0:0 \
  --delogo 3300:80:535:300 \
  --auto-aspect \
  --scale-medium \
  --trim-start 5
```
输出: 1600x900

#### 1080P视频
```bash
python3 tools/video_processing/pipeline.py \
  --episode 170 \
  --input gen_video/raw_videos/170_1080P.mp4 \
  --crop 1920:980:0:0 \
  --delogo 1650:40:200:150 \
  --auto-aspect \
  --scale-medium \
  --trim-start 5
```
输出: 1600x900（从1080P缩放到1600x900）

#### 统一超分
所有视频都缩放到1600x900后，统一使用Real-ESRGAN超分到更高分辨率。

## 参数对照表

| 分辨率 | 裁剪参数 | delogo参数 | 缩放后 |
|--------|---------|-----------|--------|
| 4K (3840x2160) | 3840:1960:0:0 | 3300:80:535:300 | 1600x900 |
| 1080P (1920x1080) | 1920:980:0:0 | 1650:40:200:150 | 1600x900 |

## 如果选择方案1（4K直接转1080P）

如果决定统一转成1080P，可以这样处理：

#### 4K视频（转成1080P）
```bash
python3 tools/video_processing/pipeline.py \
  --episode 142 \
  --input gen_video/raw_videos/142_4K.mp4 \
  --crop 3840:1960:0:0 \
  --delogo 3300:80:535:300 \
  --auto-aspect \
  --scale 1920:1080 \
  --trim-start 5
```
输出: 1920x1080（与1080P视频一致）

#### 1080P视频（保持不变）
```bash
python3 tools/video_processing/pipeline.py \
  --episode 170 \
  --input gen_video/raw_videos/170_1080P.mp4 \
  --crop 1920:980:0:0 \
  --delogo 1650:40:200:150 \
  --auto-aspect \
  --scale 1920:1080 \
  --trim-start 5
```
输出: 1920x1080

## 建议

**如果追求质量和未来扩展性**: 使用方案3（统一缩放到1600x900，然后超分）

**如果追求速度和存储效率**: 使用方案1（4K直接转1080P）

**如果追求最高质量**: 使用方案2（保持4K，分别处理）

